#!/bin/bash

WORKROOT="$(git rev-parse --show-toplevel)"
RC="$?"
case "$RC" in
0)
	;;
*)
	echo 1>&2 "Failed to detect WORKROOT($RC). Please check if git repo is properly checked out."
	exit 1
	;;
esac

PROBLEM="$1"
case "$PROBLEM" in
'')
	echo 1>&2 "PROBLEM is not specified."
	exit 1
	;;
esac

CPFROM="${WORKROOT}/lib/template.scm"
CPTO="./${PROBLEM}.scm"

if [ -e "$CPTO" ]
then
	echo 1>&2 "$CPTO already exists. Overwrite? [y/N]"
	read C
	RC="$?"
	case "$RC" in
	0)
		;;
	*)
		echo 1>&2 "Canceled."
		exit 1
		;;
	esac
	case "$C" in
	Y|y)
		;;
	*)
		echo 1>&2 "Canceled."
		exit 1
		;;
	esac
fi

set -x
cp "$CPFROM" "$CPTO"
